

# TOP K

## 最近一小时访问频次最高的IP

题目：=

>实时输出最近一个小时内访问频率最高的10个IP，要求：
>
>- 实时输出
>- 从当前时间向前数的1个小时
>- QPS可能会达到10W/s



1. uint不能直接相减，结果是负数会变成一个很大的uint，这点对动态语言出身的会可能坑。

2. 从slice创建slice的时候，注意原slice的操作可能导致底层数组变化。

3. 如果你要创建一个很长的slice，尽量创建成一个slice里存引用，这样可以分批释放，避免gc在低配机器上stop the world
4. 尽量了解golang的内存模型，知道多小才是小对象，为什么小对象多了会造成gc压力。

-----

1、空struct{}是否使用过？会在什么情况下使用，举例说明一下。 

2、在Go语言中，结构体是否能够比较？该如何比较两个结构体？如何比较两个接口？可以顺便查考一下代码实现。 

3、使用Go语言编程实现堆栈和队列这两个数据结构，该如何实现。可以只说实现思路。 

4、var a []int和a := []int{}是否有区别？如果有的话，具体有什么区别？在开发过程中使用哪个更好，为什么？ 

5、Go中，如何复制切片内容？如何复制map内容？如何复制接口内容？编程时会如何操作实现。





















# 网路



## 正向代理与反向代理

https://cloud.tencent.com/developer/article/1418457  文章写的非常不错 

1. **正向代理其实是客户端的代理**，帮助客户端访问其无法访问的服务器资源。**反向代理则是服务器的代理**，帮助服务器做负载均衡，安全防护等。
2. **正向代理一般是客户端架设的**，比如在自己的机器上安装一个代理软件。而**反向代理一般是服务器架设的**，比如在自己的机器集群中部署一个反向代理服务器。
3. **正向代理中，服务器不知道真正的客户端到底是谁**，以为访问自己的就是真实的客户端。而在**反向代理中，客户端不知道真正的服务器是谁**，以为自己访问的就是真实的服务器。
4. 正向代理和反向代理的作用和目的不同。**正向代理主要是用来解决访问限制问题。而反向代理则是提供负载均衡、安全防护等作用。二者均能提高访问速度。**



## **channel是****线程****安全的吗**

> *Golang**的Channel,发送一个数据到Channel 和从Channel接收一个数据都是原子性的。*
>
> *这个可以看源码就知道channel内部维护了一个互斥锁，来保证**线程**安全：*
>
> *[go channe设计原理](https://github.com/golang/go/blob/master/src/runtime/chan.go)*
>
> *而且Go的设计思想就是:不要通过共享内存来通信，而是通过通信来共享内存，前者就是传统的加锁，后者就是Channel。*
>
> *也就是说，设计Channel的主要目的就是在多任务间传递数据的，这当然是安全的.因为channel底层实现出队入队时也加锁了.*

## **mutex是悲观锁还是乐观锁**

## **rwmutex**

## **无锁保护的map**

> 1. *cas**操作*

## **字符串****转化为Byte数组发生内存拷贝么**

> *会发生内存拷贝*

> *但是想转换的时候不发生内存拷贝 需要怎么做呢*
>
> *Unsafe .point方法 把**字符串**底层数组指针 指向我们的转化字节数组*

## **cpu缓存一致性如何保证**

> *[https://xiaolincoding.com/os/1_hardware/cpu_mesi.html#%E6%80%BB%E7%BB%93](https://xiaolincoding.com/os/1_hardware/cpu_mesi.html#总结)*

## **实现循环打印数字**

## **项目热编译如何实现？**

## **Slice扩容机制**

## **Sync包mutex实现**

## **GPM****调度与垃圾回收**

## **小于n的最大数**

问题描述：给一个数组nums=[5,4,8,2],给一个n=5416， 让你从nums中选出一些元素，使得组成的数字是小于n的最大数，比如这个例子应该返回5288，当时没想出来，让面试官换了一道题，事后顺着一些大佬的思路写了下，感觉贪心加二分这个思路比较接近正确答案，有没有人看下这个方法行不行

> *6.1 map怎么实现，底层是什么（数组），**哈希**表是什么，k-v是怎么实现的，哈希函数的作用，映射到数组上，哈希冲突怎么实现，链表法里面是什么*
>
> *6.2* *gmp*
>
> *6.3 垃圾及回收机制，垃圾回收主要是什么，垃圾回收需要暂停程序么*
>
> *6.4 读写屏障，为啥需要读写屏障，最终清扫需要关闭程序么*
>
> *6.5* *k8s**用过么*

## **go实现延迟****队列**

https://juejin.cn/post/7146641201301569566



## 令牌桶算法

https://mp.weixin.qq.com/s/krrUFEHVBw4c-47ziXOK2w

https://juejin.cn/post/6981291908291100680

# 一

1. nacos注册中心是AP还是CP  nacos还有什么用途

2. 了解rpc的调用吗  说一下微服务openfin

3. openfin底层原理

4. redis瞬间有大量key失效，为什么会影响别得key读取性能，需要再底层进行研究

5. 项目中分布式锁是如何实现的

6. 什么是IO多路复用

7. mysql rc、rr分别解决了什么？项目中使用那种隔离级别，为什么这样选择

   1. https://www.cnblogs.com/hollischuang/p/15522907.html

8. 实际工作共有遇到mysql的死锁？说一下解决办法

9. rocketMq重复消费问题，以及事务消息的原理？消息丢失？

10. 项目中分布式事务是怎么做的？

11. golang中defer关键字

    

场景提：

1.  数据量很大的情况下，需要现从db中查询到用户基础信息，然后根据用户基础信息去查询redis中关联的用户关联信息，这里忽略OOM情况下，有什么办法去提升性能呢
2.  mysql的InnoDB ，myisAm引擎中使用自增长主键，当突然断电重启，两个引擎中的自增主键会连续吗？讲述一下原因



# 二

1. kaifa如何保证不重复消费
2. raft算法



# 三

1. select * from table where A='A'  A字段建立索引了，问什么情况下该表查询语句不走索引
2. 10亿个key钟判断某个key是否存在？
   1. 要求内存空间不能太大
   2. 查询流量QPS在500w左右
   3. 如何解决hash冲突

# 四

1. gin框架路由是怎么实现的，具体正则怎么匹配？限流中间件怎么做
2. go的slice与数组有什么区别，slice的实现原理
3. golang协程调度，gpm模型
4. golang的channel实现，channel有缓存和无缓存
5. golang的关键字 defer、recover、panic
6. sync包里边的锁、原子操作、waitgroup之类
7. make和new区别，引用类型和非引用类型值传递之类的

# 五

1. redis中有一批key瞬间过期，为什么其他key的读写效率会变慢
2. 3000万db分页数据怎么处理
3. 怎么实现滑动窗口限流
4. 查询接口调优，不能用缓存，要求实时性，怎么调优
5. Redis set底层什么时候用hash，什么时候用跳表  重点
6. 用户下单后，订单按什么字段分表?分表之后时间范围查询订单怎么办

# 六

1. cas具体是怎么实现的
2. 并发使用map除了加锁还有什么方法
3. 有对比sync.Map和加锁的区别吗
4. 说一下redis分布式锁的实现
   1. 基于redis分布式锁会有什么问题
   2. redis分布式锁锁超时时间可以设置长一点吗，不可以的话需要怎么解决
   3. 对redis锁续期如何实现
   4. 日常在用的redis集群都是什么架构？在主从模式和redis cluster中分布式锁会有什么问题。



# 七

1. 分布式限流器
2. 熔断降级  https://sentinelguard.io/zh-cn/docs/golang/circuit-breaking.html





# 八

缓存与持久化 双写一致性 

CPU多级缓存实现

Mysql索引创建原则



